!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.simplecrop=e():t.SimpleCrop=e()}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){var n,r,o;r=[i(1),i(2),i(3)],void 0===(o="function"==typeof(n=function(t,e,i){var n=function(){var t,e=document.createElement("div"),i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",MsTransition:"msTransitionEnd"};for(t in i)if(void 0!==e.style[t])return i[t]}(),r=t.prefix("transform"),o=t.prefix("transition");function s(t){this.id="crop-"+(new Date).getTime(),this.initSize={width:t.size.width,height:t.size.height},this.visible=null==t.visible||t.visible,this.debug=null!=t.debug&&t.debug,this.$container=null!=t.$container?t.$container:document.body;var e=this;e.passiveSupported=!1;try{var i=Object.defineProperty({},"passive",{get:function(){e.passiveSupported=!0}});window.addEventListener("test",null,i)}catch(t){}this.isSupportTouch="ontouchend"in document,this._precision=5,this._multiPoint=!1,this._rotateScale=1,this._baseMoveX=0,this._curMoveX=0,this._changedX=0,this._downPoints=[],this._isControl=!1,this._baseAngle=0,this.scaleTimes=1,this.rotateAngle=0,this.construct(),this.initFuncBtns(t),this.initRotateSlider(t),this.initChilds(),this.initTitle(t),this.initBox(t),this.initBoxBorder(t,!0),this.initBoxCursor(t),this.setImage(null!=t.src?t.src:this.src),this.bindEvent()}return Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){var i=Object(this),n=i.length>>>0;if(0===n)return!1;for(var r,o,s=0|e,a=Math.max(s>=0?s:n-Math.abs(s),0);a<n;){if((r=i[a])===(o=t)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;a++}return!1}}),s.prototype.initTitle=function(t){this.title=null!=t.title?t.title:"",this.$title=document.querySelector("#"+this.id+" .crop-title"),this.$title.innerText=this.title},s.prototype.initBoxBorder=function(t,e){this.borderWidth=null!=t.borderWidth?t.borderWidth:2,this.borderColor=null!=t.borderColor?t.borderColor:"#fff",this.boldCornerLen=null!=t.boldCornerLen?t.boldCornerLen:32,this.boldCornerWidth=t.boldCornerWidth?t.boldCornerWidth:4,this.coverColor=null!=t.coverColor?t.coverColor:"rgba(0,0,0,.3)",this.coverDraw=null!=t.coverDraw?t.coverDraw:function(){},this.borderDraw=null!=t.borderDraw?t.borderDraw:this.defaultBorderDraw,e||(this.borderDraw(this.$cropCover),this.coverDraw(this.$cropCover))},s.prototype.initBoxCursor=function(t){const e=this.isSupportTouch?10*this.borderWidth:2*this.borderWidth;this.cursorHoverWidth=null!=t.cursorHoverWidth?t.cursorHoverWidth:e,this.isFixedAspectRatio=null!=t.isFixedAspectRatio&&t.isFixedAspectRatio},s.prototype.initFuncBtns=function(t){this.funcBtns=null!=t.funcBtns?t.funcBtns:["close","crop","around","reset"],this.cropCallback=null!=t.cropCallback?t.cropCallback:function(){},this.closeCallback=null!=t.closeCallback?t.closeCallback:function(){},this.uploadCallback=null!=t.uploadCallback?t.uploadCallback:function(){},this.$cropBtns=document.querySelector("#"+this.id+" .crop-btns");var e="";this.funcBtns.includes("upload")&&(e+='<div class="upload-btn-container">',e+='<button class="upload-btn"></button>',e+='<input type="file" accept="image/png,image/jpeg">',e+="</div>"),this.funcBtns.includes("close")&&(e+='<button class="crop-close"></button>'),this.funcBtns.includes("around")&&(e+='<button class="crop-around"></button>'),this.funcBtns.includes("reset")&&(e+='<button class="crop-reset"></button>'),this.funcBtns.includes("crop")&&(e+='<button class="crop-btn"></button>'),this.$cropBtns.innerHTML=e,this.funcBtns.includes("upload")&&(this.$uploadBtn?this.$uploadBtn.removeEventListener("change",this.__uploadInput):this.__uploadInput=this.uploadInput.bind(this),this.$uploadBtn=document.querySelector("#"+this.id+" .upload-btn-container"),this.$uploadInput=document.querySelector("#"+this.id+" .upload-btn-container input"),this.$uploadBtn.addEventListener("change",this.__uploadInput)),this.funcBtns.includes("crop")&&(this.$cropBtn?this.$cropBtn.removeEventListener("click",this.__crop):this.__crop=this.crop.bind(this),this.$cropBtn=document.querySelector("#"+this.id+" .crop-btn"),this.$cropBtn.addEventListener("click",this.__crop)),this.funcBtns.includes("around")&&(this.$aroundBtn?this.$aroundBtn.removeEventListener("click",this.__around):this.__around=this.around.bind(this),this.$aroundBtn=document.querySelector("#"+this.id+" .crop-around"),this.$aroundBtn.addEventListener("click",this.__around)),this.funcBtns.includes("reset")&&(this.$resetBtn?this.$resetBtn.removeEventListener("click",this.reset):this.__reset=this.reset.bind(this),this.$resetBtn=document.querySelector("#"+this.id+" .crop-reset"),this.$resetBtn.addEventListener("click",this.__reset)),this.funcBtns.includes("close")&&(this.$closeBtn?this.$closeBtn.removeEventListener("click",this.close):this.__close=this.close.bind(this),this.$closeBtn=document.querySelector("#"+this.id+" .crop-close"),this.$closeBtn.addEventListener("click",this.__close)),this.funcBtns.length>0?this.$cropBtns.style.visibility="":this.$cropBtns.style.visibility="hidden"},s.prototype.initRotateSlider=function(t){this.rotateSlider=null==t.rotateSlider||t.rotateSlider,this.startAngle=null!=t.startAngle?t.startAngle:-90,this.endAngle=null!=t.endAngle?t.endAngle:90,this.gapAngle=null!=t.gapAngle?t.gapAngle:10,this.lineationItemWidth=null!=t.lineationItemWidth?t.lineationItemWidth:40.5,this.lineationItemWidth=this.lineationItemWidth>=40.5?this.lineationItemWidth:40.5,this.startAngle=this.startAngle<0?parseInt(this.startAngle):0,this.endAngle=this.endAngle>0?parseInt(this.endAngle):0,this.gapAngle=this.gapAngle>0?parseInt(this.gapAngle):3,(this.endAngle-this.startAngle)%this.gapAngle!=0&&(this.endAngle=Math.ceil((this.endAngle-this.startAngle)/this.gapAngle)*this.gapAngle+this.startAngle),this.lineationWidth=this.lineationItemWidth*((this.endAngle-this.startAngle)/this.gapAngle+1),this.$cropRotate=document.querySelector("#"+this.id+" .crop-rotate"),this.$lineation=document.querySelector("#"+this.id+" .lineation"),this.$rotateCurrent=document.querySelector("#"+this.id+" .current");var e=window.getComputedStyle(this.$cropRotate);this.rotateWidth=parseFloat(e.getPropertyValue("width")),this._baseMoveX=-(this.lineationWidth*(0-this.startAngle+this.gapAngle/2)/(this.endAngle-this.startAngle+this.gapAngle)-this.rotateWidth/2);var i=this.rotateAngle-this._baseAngle;this._curMoveX=i*this.lineationWidth/(this.endAngle-this.startAngle+this.gapAngle)+this._baseMoveX,(this._curMoveX>0||this._curMoveX<this.rotateWidth-this.lineationWidth)&&(this.startControl(),this._curMoveX=this._baseMoveX,this._baseAngle=0,this.rotateAngle=0,this._changedX=0,this._rotateScale=1,this.transform(!0),this.endControl());for(var n="",o=this.startAngle;o<=this.endAngle;o+=this.gapAngle)n+='<li><div class="number">'+o+'</div><div class="bg"></div></li>';this.$lineation.innerHTML=n,this.$lineation.style.width=this.lineationWidth+"px",this.$lineation.style[r]="translateX("+this._curMoveX+"px)",this.rotateSlider?this.$cropRotate.style.visibility="":this.$cropRotate.style.visibility="hidden"},s.prototype.initChilds=function(){this.$cropMask=document.querySelector("#"+this.id+" .crop-mask");var t=this.$cropMask.getBoundingClientRect();this.maskViewSize={top:t.top,left:t.left,width:t.width,height:t.height},this.$cropCover=document.querySelector("#"+this.id+" .crop-cover"),this.cropCoverContext=this.$cropCover.getContext("2d"),this.$cropCover.width=this.maskViewSize.width*window.devicePixelRatio,this.$cropCover.height=this.maskViewSize.height*window.devicePixelRatio},s.prototype.initBox=function(t){this.size=t.size,this.positionOffset=null!=t.positionOffset?t.positionOffset:{top:0,left:0},this.cropSizePercent=null!=t.cropSizePercent?t.cropSizePercent:.5},s.prototype.updateBox=function(t){this.initBox(t),this.times=this.size.width/this.maskViewSize.width>this.size.height/this.maskViewSize.height?this.size.width/this.maskViewSize.width/this.cropSizePercent:this.size.height/this.maskViewSize.height/this.cropSizePercent,this.cropRect={width:this.size.width/this.times,height:this.size.height/this.times},this.cropRect.left=(this.maskViewSize.width-this.cropRect.width)/2-this.positionOffset.left,this.cropRect.top=(this.maskViewSize.height-this.cropRect.height)/2-this.positionOffset.top,this.initCropRect={left:this.cropRect.left,top:this.cropRect.top,width:this.cropRect.width,height:this.cropRect.height},this.cropPoints=this.rectToPoints(this.cropRect),this.cropCenter=this.getPointsCenter(this.cropPoints),this.borderDraw(this.$cropCover),this.coverDraw(this.$cropCover),this.transform(!1,!0)},s.prototype.getControlPoints=function(t){return t.touches?t.touches:[{clientX:t.clientX,clientY:t.clientY}]},s.prototype.getControlEvents=function(){return this.isSupportTouch?{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"}:{start:"mousedown",move:"mousemove",end:"mouseup",cancel:"mouseleave"}},s.prototype.construct=function(){var t="";t+='<div class="crop-component">',t+='<p class="crop-title"></p>',t+='<div class="crop-mask">',t+='<canvas class="crop-cover"></canvas>',t+="</div>",this.rotateSlider?t+='<div class="crop-rotate">':t+='<div class="crop-rotate" style="visibility:hidden;">',t+='<ul class="lineation">',t+="</ul>",t+='<div class="current"></div>',t+="</div>",t+='<div class="crop-btns" style="visibility:hidden;"></div>',t+="</div>",this.$target=document.createElement("div"),this.$target.id=this.id,this.$target.classList.add("crop-whole-cover"),this.visible?this.$target.style.visibility="":this.$target.style.visibility="hidden",this.$target.innerHTML=t,this.$container.appendChild(this.$target)},s.prototype.defaultBorderDraw=function(t){var e=this.borderWidth,i=this.boldCornerWidth,n=this.boldCornerLen;n=n>=2*e?n:2*e;var r=t.width,o=t.height;this.cropCoverContext.clearRect(0,0,r,o),this.cropCoverContext.fillStyle=this.coverColor,this.cropCoverContext.fillRect(0,0,r,o);var s={left:this.cropRect.left*window.devicePixelRatio,top:this.cropRect.top*window.devicePixelRatio,width:this.cropRect.width*window.devicePixelRatio,height:this.cropRect.height*window.devicePixelRatio};this.cropCoverContext.fillStyle=this.borderColor,this.cropCoverContext.fillRect(s.left,s.top,s.width,s.height),this.boldCornerLen>0&&(this.cropCoverContext.fillRect(s.left-i,s.top-i,n,n),this.cropCoverContext.fillRect(s.left+s.width-n+i,s.top-i,n,n),this.cropCoverContext.fillRect(s.left-i,s.top+s.height-n+i,n,n),this.cropCoverContext.fillRect(s.left+s.width-n+i,s.top+s.height-n+i,n,n));var a=document.createElement("canvas");a.width=s.width,a.height=24;var c=a.getContext("2d");c.font="24px Calibri",c.fillStyle=this.borderColor,c.textBaseline="middle",c.textAlign="center";var h=parseInt(this.size.width*this.cropRect.width/this.initCropRect.width),l=parseInt(this.size.height*this.cropRect.height/this.initCropRect.height);c.fillText(h+" x "+l,a.width/2,a.height/2),this.cropCoverContext.drawImage(a,0,0,a.width,a.height,s.left,s.top-24-2*this.boldCornerWidth,a.width,a.height),this.cropCoverContext.clearRect(s.left+e,s.top+e,s.width-2*e,s.height-2*e)},s.prototype.init=function(){var t=this.contentWidth/2,e=this.contentHeight/2;this.initContentPoints=[{x:-t,y:e},{x:t,y:e},{x:t,y:-e},{x:-t,y:-e}],this.contentPoints=this.initContentPoints.slice(),this.size.width/this.size.height>this.contentWidth/this.contentHeight?this.initScale=this.size.width/this.contentWidth:this.initScale=this.size.height/this.contentHeight,this.reset()},s.prototype.reset=function(){this.startControl(),this._contentCurMoveX=-this.positionOffset.left,this._contentCurMoveY=-this.positionOffset.top,this._rotateScale=1,this._baseAngle=0,this.rotateAngle=0,this._curMoveX=this._baseMoveX,this._changedX=0,this.$lineation.style[r]="translateX("+this._baseMoveX+"px)",this.scaleTimes=this.initScale,this.updateBox({positionOffset:this.positionOffset,cropSizePercent:this.cropSizePercent,size:{width:this.initSize.width,height:this.initSize.height}}),this.endControl()},s.prototype.load=function(){var t=this;t.originImage.onload=function(){e.getData(t.originImage,(function(){t._orientation=e.getTag(this,"Orientation"),t.getRealCotentSize(),t.transformCoordinates(),t.init()}))}},s.prototype.setImage=function(t){if(null!=t&&""!=t){var e=this,i=Object.prototype.toString.call(t);"[object String]"===i?(e.src=t,e.originImage=new Image,e.originImage.crossOrigin="Anonymous",e.originImage.src=e.src,e.load(),e.uploadCallback(e.src)):"[object File]"===i&&e.fileToSrc(t,(function(t){e.src=t,e.originImage=new Image,e.originImage.crossOrigin="Anonymous",e.originImage.src=e.src,e.load(),e.uploadCallback(e.src)}))}},s.prototype.show=function(t){t&&this.setImage(t),this.visible=!0,this.$target.style.visibility=""},s.prototype.hide=function(){this.visible=!1,this.$target.style.visibility="hidden"},s.prototype.close=function(){this.hide(),this.closeCallback()},s.prototype.crop=function(){this.getCropImage(),this.cropCallback(this.$resultCanvas),this.hide()},s.prototype.uploadInput=function(t){var e=t.target.files;e.length>0&&this.show(e[0]),this.$uploadInput.value=""},s.prototype.around=function(){this.startControl(),this.rotateAngle=(this._baseAngle-90)%360,this._baseAngle=this.rotateAngle,this._curMoveX=this._baseMoveX,this._changedX=0,this._rotateScale=1,this.$lineation.style[r]="translateX("+this._baseMoveX+"px)",this.transform(!1,!0),this.endControl()},s.prototype.moveCursor=function(t){var e=t[0].clientX-this.maskViewSize.left,i=t[0].clientY-this.maskViewSize.top,n=this.cropRect.left+this.cursorHoverWidth,r=this.cropRect.top+this.cursorHoverWidth,o=this.cropRect.width-2*this.cursorHoverWidth,s=this.cropRect.height-2*this.cursorHoverWidth,a=this.cropRect.left-this.cursorHoverWidth,c=this.cropRect.top-this.cursorHoverWidth,h=this.cropRect.width+2*this.cursorHoverWidth,l=this.cropRect.height+2*this.cursorHoverWidth;e>=a&&e<=a+h&&i>=c&&i<=l+c&&!(e>=n&&e<=n+o&&i>=r&&i<=s+r)?e<=a+this.boldCornerLen&&i<=c+this.boldCornerLen?(this.$cropCover.style.cursor="nwse-resize",this._moveCursor="crop_leftTop"):e<=a+this.boldCornerLen&&i>=l+c-this.boldCornerLen?(this.$cropCover.style.cursor="nesw-resize",this._moveCursor="crop_leftBottom"):e>=h+a-this.boldCornerLen&&i<=c+this.boldCornerLen?(this.$cropCover.style.cursor="nesw-resize",this._moveCursor="crop_rightTop"):e>=h+a-this.boldCornerLen&&i>=l+c-this.boldCornerLen?(this.$cropCover.style.cursor="nwse-resize",this._moveCursor="crop_rightBottom"):i<=c+this.boldCornerLen&&!this.isFixedAspectRatio?(this.$cropCover.style.cursor="ns-resize",this._moveCursor="crop_top"):i>=l+c-this.boldCornerLen&&!this.isFixedAspectRatio?(this.$cropCover.style.cursor="ns-resize",this._moveCursor="crop_bottom"):e<=a+this.boldCornerLen&&!this.isFixedAspectRatio?(this.$cropCover.style.cursor="ew-resize",this._moveCursor="crop_left"):e>=h+a-this.boldCornerLen&&!this.isFixedAspectRatio&&(this.$cropCover.style.cursor="ew-resize",this._moveCursor="crop_right"):(this.$cropCover.style.cursor="move",this._moveCursor="move")},s.prototype.cropMove=function(t){var e=t[0],i=this._downPoints[0],n=this._moveCursorAction.toLowerCase(),r=e.clientX-i.clientX,o={clientX:e.clientX,clientY:e.clientY};if(!(-1==n.indexOf("left")&&-1==n.indexOf("right")||-1==n.indexOf("top")&&-1==n.indexOf("bottom"))){var s=0;s=["crop_lefttop","crop_rightbottom"].includes(n)?1:-1;var a=r*this.initCropRect.height/this.initCropRect.width;o.clientY=i.clientY+a*s}-1!=n.indexOf("left")&&(this.cropRect.left=this.initCropRect.left+(o.clientX-i.clientX),this.cropRect.width=this.initCropRect.width-(o.clientX-i.clientX)),-1!=n.indexOf("right")&&(this.cropRect.width=this.initCropRect.width+(o.clientX-i.clientX)),-1!=n.indexOf("top")&&(this.cropRect.top=this.initCropRect.top+(o.clientY-i.clientY),this.cropRect.height=this.initCropRect.height-(o.clientY-i.clientY)),-1!=n.indexOf("bottom")&&(this.cropRect.height=this.initCropRect.height+(o.clientY-i.clientY)),this.cropRect.width<=this.boldCornerLen&&(this.cropRect.width=this.boldCornerLen),this.cropRect.height<=this.boldCornerLen&&(this.cropRect.height=this.boldCornerLen),this.borderDraw(this.$cropCover),this.coverDraw(this.$cropCover)},s.prototype.bindEvent=function(){var t=this,e=this.getControlEvents();t.$cropRotate.addEventListener(e.start,(function(e){var i=t.getControlPoints(e);t.startControl(i)})),t.$cropRotate.addEventListener(e.move,(function(e){var i=t.getControlPoints(e);if(t._downPoints&&t._downPoints.length>0&&!t._multiPoint){var n=i[0].clientX-t._downPoints[0].clientX,o=t._curMoveX+n;if(o<=0&&o>=t.rotateWidth-t.lineationWidth){var s=(o-t._baseMoveX)/t.lineationWidth*(t.endAngle-t.startAngle+t.gapAngle);t._curMoveX=o,t._changedX=n,t.$lineation.style[r]="translateX("+o+"px)";var a=t.getRotateTranslate(t._baseAngle+s-t.rotateAngle,t.cropCenter);t._contentCurMoveX-=a.translateX,t._contentCurMoveY+=a.translateY,t.rotateAngle=t._baseAngle+s,t.transform(!0),t._downPoints=i}}e.stopPropagation(),e.preventDefault()})),t.$cropRotate.addEventListener(e.end,t.endControl.bind(t)),t.$cropRotate.addEventListener(e.cancel,t.endControl.bind(t));var i=t.isSupportTouch?t.$container:t.$cropMask;i.addEventListener(e.start,(function(e){var i=t.getControlPoints(e);if(t.startControl(i),t._multiPoint=!1,t.moveCursor(i),t._downPoints&&t._downPoints.length>=2){t._multiPoint=!0;var n={clientX:(t._downPoints[0].clientX+t._downPoints[1].clientX)/2,clientY:(t._downPoints[0].clientY+t._downPoints[1].clientY)/2};t.fingerLen=Math.sqrt(Math.pow(t._downPoints[0].clientX-t._downPoints[1].clientX,2)+Math.pow(t._downPoints[0].clientY-t._downPoints[1].clientY,2)),t.fingerScale=1,t.fingerCenter={x:n.clientX-t.maskViewSize.width/2,y:t.maskViewSize.height/2-n.clientY}}else t._moveCursor&&-1!=t._moveCursor.indexOf("crop_")&&(t._moveCursorAction=t._moveCursor)}));var n=!!t.passiveSupported&&{passive:!1,capture:!1};i.addEventListener(e.move,(function(e){var i=t.getControlPoints(e);if(t._downPoints&&t._downPoints.length>0)if(t._multiPoint){var n=Math.sqrt(Math.pow(i[0].clientX-i[1].clientX,2)+Math.pow(i[0].clientY-i[1].clientY,2))/t.fingerLen;t.scaleTimes=t.scaleTimes/t.fingerScale*n;var r=t.getScaleTranslate(n/t.fingerScale,t.fingerCenter);t._contentCurMoveX-=r.translateX,t._contentCurMoveY+=r.translateY,t.fingerScale=n,t.transform(!1,!0)}else t._moveCursorAction?t.cropMove(i):t.contentMove(i);else t.moveCursor(i);t.visible&&e.preventDefault()}),n),i.addEventListener(e.end,t.endControl.bind(t)),i.addEventListener(e.cancel,t.endControl.bind(t)),i.addEventListener("wheel",(function(e){t._wheelTimeout||t.startControl(),e.preventDefault(),e.wheelDelta>0?t.scaleTimes=t.scaleTimes*(e.wheelDelta/12e3+1):t.scaleTimes=t.scaleTimes/(1-e.wheelDelta/12e3),t.transform(!1,!0),t._wheelTimeout&&clearTimeout(t._wheelTimeout),t._wheelTimeout=setTimeout((function(){t.endControl(),t._wheelTimeout=null}),100)}))},s.prototype.getScaleTranslate=function(t,e){for(var i=[],n=this.getPointsCenter(this.contentPoints),r=0;r<this.contentPoints.length;r++){var o=this.contentPoints[r];i.push({x:o.x*t-e.x*(t-1),y:o.y*t-e.y*(t-1)})}var s=this.getPointsCenter(i);return{translateX:n.x-s.x,translateY:n.y-s.y}},s.prototype.getRotateTranslate=function(t,e){var i=this.getPointsCenter(this.contentPoints),n={x:(i.x-e.x).toFixed(this._precision),y:(i.y-e.y).toFixed(this._precision)};if(this.vecLen(n)>0&&0!=t){var r=t/180*Math.PI,o={x:Math.cos(-r)*n.x-Math.sin(-r)*n.y,y:Math.sin(-r)*n.x+Math.cos(-r)*n.y};return{translateX:n.x-o.x,translateY:n.y-o.y}}return{translateX:0,translateY:0}},s.prototype.getRealCotentSize=function(){this.contentWidth=this.originImage.width,this.contentHeight=this.originImage.height,this._orientation>4&&(this.contentWidth=this.originImage.height,this.contentHeight=this.originImage.width)},s.prototype.transformCoordinates=function(){this.$cropContent&&this.$cropMask.removeChild(this.$cropContent),this.$cropContent=document.createElement("canvas"),this.$cropContent.width=this.contentWidth,this.$cropContent.height=this.contentHeight;var t=this.$cropContent.getContext("2d"),e=this.originImage.width,i=this.originImage.height;switch(this._orientation){case 2:t.translate(e,0),t.scale(-1,1);break;case 3:t.translate(e,i),t.rotate(Math.PI);break;case 4:t.translate(0,i),t.scale(1,-1);break;case 5:t.rotate(.5*Math.PI),t.scale(1,-1);break;case 6:t.rotate(.5*Math.PI),t.translate(0,-i);break;case 7:t.rotate(.5*Math.PI),t.translate(e,-i),t.scale(-1,1);break;case 8:t.rotate(-.5*Math.PI),t.translate(-e,0)}t.drawImage(this.originImage,0,0,e,i),this._initTransform="translate3d(-50%,-50%,0)",this.$cropContent.classList.add("crop-content"),this.$cropContent.style.position="absolute",this.$cropContent.style.left="50%",this.$cropContent.style.top="50%",this.$cropContent.style[r]=this._initTransform,this.$cropMask.insertBefore(this.$cropContent,this.$cropCover)},s.prototype.getCropImage=function(){var t=this.scaleTimes/this.times*this._rotateScale,e=this.contentWidth,i=this.contentHeight,n=this.size.width,r=this.size.height,o=1;(e<n||i<r)&&(n/e>r/i?(i*=o=n/e,e=n):(e*=o=r/i,i=r));var s={x:e/2,y:i/2},a=document.createElement("canvas");a.width=e,a.height=i;var c=a.getContext("2d");c.translate(s.x,s.y),c.scale(t*this.times/o,t*this.times/o),c.translate((this._contentCurMoveX+this.positionOffset.left)/t*o,(this._contentCurMoveY+this.positionOffset.top)/t*o),c.rotate(this.rotateAngle/180*Math.PI),c.translate(-s.x,-s.y),c.drawImage(this.$cropContent,0,0,e,i);var h=document.createElement("canvas");h.width=n,h.height=r,h.getContext("2d").drawImage(a,(e-n)/2,(i-r)/2,n,r,0,0,n,r),this.$resultCanvas=h},s.prototype.endControl=function(){if(this._isControl){var t=this;if(this._downPoints=[],this._moveCursorAction){const n={width:this.cropRect.width/this.initCropRect.width*this.size.width,height:this.cropRect.height/this.initCropRect.height*this.size.height},r=n.width/this.maskViewSize.width>n.height/this.maskViewSize.height?n.width/this.maskViewSize.width/this.cropSizePercent:n.height/this.maskViewSize.height/this.cropSizePercent;for(var e=this.rectToPoints(this.cropRect),i=this.getPointsCenter(e),s=[],a=0;a<e.length;a++)s.push(this.vecLen({x:e[a].x-this.cropPoints[a].x,y:e[a].y-this.cropPoints[a].y}));for(var c=[0],h=s[0],l=1;l<s.length;l++)s[l]<h?(h=s[l],c=[l]):s[l]==h&&c.push(l);var u={x:this.cropPoints[c[0]].x,y:this.cropPoints[c[0]].y};2==c.length&&(u.x=(this.cropPoints[c[0]].x+this.cropPoints[c[1]].x)/2,u.y=(this.cropPoints[c[0]].y+this.cropPoints[c[1]].y)/2);var p=this._moveCursorAction.toLowerCase();this._moveCursorAction=null;var d=-1!=p.indexOf("left")||-1!=p.indexOf("right"),f=-1!=p.indexOf("top")||-1!=p.indexOf("bottom"),g=d?this.initCropRect.width/this.cropRect.width:this.initCropRect.height/this.cropRect.height,v=t.getScaleTranslate(g,{x:u.x,y:u.y});d&&f?(this._contentCurMoveX-=v.translateX,this._contentCurMoveY+=v.translateY):d?0==Math.abs(this.times/r-g).toFixed(this._precision)?this._contentCurMoveX-=v.translateX*g/this.times*r:(this._contentCurMoveX-=i.x-this.positionOffset.left,this._contentCurMoveX*=this.times/r):f&&(0==Math.abs(this.times/r-g).toFixed(this._precision)?this._contentCurMoveY+=v.translateY*g/this.times*r:(this._contentCurMoveY+=i.y-this.positionOffset.top,this._contentCurMoveY*=this.times/r)),this.updateBox({positionOffset:this.positionOffset,cropSizePercent:this.cropSizePercent,size:{width:n.width,height:n.height}})}if(this.$cropContent&&!this.isWholeCover(this.contentPoints,this.cropPoints)){var m=this.scaleTimes/this.times*this._rotateScale,y="";y+=" scale("+m+")",y+=" translateX("+this._contentCurMoveX/m+"px) translateY("+this._contentCurMoveY/m+"px)",y+=" rotate("+this.rotateAngle+"deg) ";var C=this.getCoverTransform(y),x=this.getTransformMatrix(C);if(this._contentCurMoveX=x.e,this._contentCurMoveY=x.f,this.contentPoints=this.getTransformPoints("scaleY(-1)"+C,this.initContentPoints),this.debug){this.$cropContent.style[o]="transform .5s linear";var b=C.indexOf(y)+y.length,w=C.substring(b,C.length).trim().split(" "),P=0,S=this._initTransform+y+w[P];this.$cropContent.style[r]=S,this.$cropContent.addEventListener(n,(function(){++P<C.length&&(S+=w[P],t.$cropContent.style[r]=S)}))}else this.$cropContent.style[r]=this._initTransform+C}this._isControl=!1}},s.prototype.startControl=function(t){t=t||[],this._isControl&&!this.isTwoFingerEvent(t)||(this._isControl=!0,this.$cropContent&&(this.$cropContent.style[o]="none"),this._downPoints=t)},s.prototype.isTwoFingerEvent=function(t){return!!(this._isControl&&this._downPoints&&1==this._downPoints.length&&t.length>=2&&(t[0].clientX==this._downPoints[0].clientX&&t[0].clientY==this._downPoints[0].clientY||t[1].clientX==this._downPoints[0].clientX&&t[1].clientY==this._downPoints[0].clientY))},s.prototype.contentMove=function(t){var e=t[0],i=e.clientX-this._downPoints[0].clientX,n=e.clientY-this._downPoints[0].clientY;this._contentCurMoveX+=i,this._contentCurMoveY+=n,this._downPoints=t,this.transform()},s.prototype.transform=function(t,e){if(this.$cropContent){var i=this.scaleTimes/this.times*this._rotateScale,n="";if(n+=" scale("+i+")",n+=" translateX("+this._contentCurMoveX/i+"px) translateY("+this._contentCurMoveY/i+"px)",n+=" rotate("+this.rotateAngle+"deg)",e){n=this.getCoverTransform(n,!0);var o=this.getTransformMatrix(n);this._contentCurMoveX=o.e,this._contentCurMoveY=o.f}if(t){var s=this.getTransformPoints("scaleY(-1)"+n,this.initContentPoints),a=this.getCoverRectScale(s,this.cropPoints),c=this._changedX,h=this._curMoveX-c-this._baseMoveX,l=this.getPointsCenter(s),u={x:l.x-this.cropCenter.x,y:l.y-this.cropCenter.y},p=Math.abs(c)/Math.abs(h);a>1?(this._rotateScale=this._rotateScale*a,i*=a):this.vecLen(u)<1&&p>0&&(a<1-p&&(a=1-p),this._rotateScale*a>1?this._rotateScale=this._rotateScale*a:(this._rotateScale=1,a=1),i*=a)}n="",n+=" scale("+i+")",n+=" translateX("+this._contentCurMoveX/i+"px) translateY("+this._contentCurMoveY/i+"px)",n+=" rotate("+this.rotateAngle+"deg)",this.$cropContent.style[r]=this._initTransform+n,this.contentPoints=this.getTransformPoints("scaleY(-1)"+n,this.initContentPoints)}},s.prototype.getCoverRectScale=function(t,e){for(var i=0,n=0;n<e.length;n++){var r=this.getCoverPointScale(e[n],t);r>i&&(i=r)}return i},s.prototype.isWholeCover=function(t,e){for(var i=0;i<e.length;i++)if(!this.isPointInRectCheckByLen(e[i],t))return!1;return!0},s.prototype.getCoverPointScale=function(t,e){var i=this.getPCVectorProjOnUpAndRight(t,e),n=this.vecLen(i.uproj),r=this.vecLen(i.up)/2,o=this.vecLen(i.rproj),s=this.vecLen(i.right)/2;return n/r>o/s?1+(n-r)/r:1+(o-s)/s},s.prototype.getCoverTransform=function(t,e){var i=this.getCoveRect(this.cropPoints,this.rotateAngle);e=e||!1;var n=1,r=1,o={x:this.contentPoints[1].x-this.contentPoints[2].x,y:this.contentPoints[1].y-this.contentPoints[2].y},s={x:this.contentPoints[1].x-this.contentPoints[0].x,y:this.contentPoints[1].y-this.contentPoints[0].y},a={x:i[1].x-i[2].x,y:i[1].y-i[2].y},c={x:i[1].x-i[0].x,y:i[1].y-i[0].y},h=this.vecAngle(o,a);Math.abs(180-h)<Math.abs(90-h)||Math.abs(0-h)<Math.abs(90-h)?(n=this.vecLen(a)/this.vecLen(o),r=this.vecLen(c)/this.vecLen(s)):(n=this.vecLen(a)/this.vecLen(s),r=this.vecLen(c)/this.vecLen(o));var l=(n=n<1?1:n)>(r=r<1?1:r)?n:r;if(e&&l>1)return t;for(var u=[],p=0;p<this.contentPoints.length;p++)u.push({x:this.contentPoints[p].x,y:this.contentPoints[p].y});l>1&&(t+=" scale("+l+")",this.scaleTimes=this.scaleTimes*l,u=this.getTransformPoints("scaleY(-1)"+t,this.initContentPoints));var d=this.scaleTimes/this.times*this._rotateScale,f=0,g=this,v=[];do{if((v=this.getOutDetails(this.cropPoints,u)).length>0){f++,v.sort((function(t,e){var i=g.vecLen(t.iv),n=g.vecLen(e.iv);return i<n?1:i>n?-1:0}));var m=v[0],y=m.pcv;h=this.vecAngle(y.up,y.uproj);var C=this.vecLen(y.uproj),x=0;0!=(x=Math.abs(h)<90?-C*m.uOver:C*m.uOver)&&(t+=" translateY("+x/d+"px)");var b=this.vecAngle(y.right,y.rproj),w=this.vecLen(y.rproj),P=0;if(0!=(P=Math.abs(b)<90?w*m.rOver:-w*m.rOver)&&(t+=" translateX("+P/d+"px)"),0!=P||0!=x)for(p=0;p<u.length;p++)u[p].x=u[p].x+m.iv.x,u[p].y=u[p].y+m.iv.y}}while(f<2&&v.length>0);return t},s.prototype.getOutDetails=function(t,e){for(var i=[],n=0;n<t.length;n++){var r=t[n];if(!this.isPointInRectCheckByLen(r,e)){var o=this.getPCVectorProjOnUpAndRight(r,e),s={x:0,y:0},a=this.vecLen(o.uproj),c=this.vecLen(o.up)/2,h=this.vecLen(o.rproj),l=this.vecLen(o.right)/2,u=0,p=0;a>c&&(u=(a-c)/a,s.x+=o.uproj.x*u,s.y+=o.uproj.y*u),h>l&&(p=(h-l)/h,s.x+=o.rproj.x*p,s.y+=o.rproj.y*p),i.push({x:r.x,y:r.y,iv:s,uOver:u,rOver:p,pcv:o})}}return i},s.prototype.getCoveRect=function(t,e){e<0?e=90+e%90:e%=90;var i=e/180*Math.PI,n={x:t[1].x-t[2].x,y:t[1].y-t[2].y},r={x:t[1].x-t[0].x,y:t[1].y-t[0].y},o=this.vecLen(r),s=this.vecLen(n),a=[];return a[0]={},a[0].x=t[0].x+o*Math.sin(i)*Math.sin(i),a[0].y=t[0].y+o*Math.sin(i)*Math.cos(i),a[1]={},a[1].x=t[1].x+s*Math.sin(i)*Math.cos(i),a[1].y=t[1].y-s*Math.sin(i)*Math.sin(i),a[2]={},a[2].x=t[2].x-o*Math.sin(i)*Math.sin(i),a[2].y=t[2].y-o*Math.sin(i)*Math.cos(i),a[3]={},a[3].x=t[3].x-s*Math.sin(i)*Math.cos(i),a[3].y=t[3].y+s*Math.sin(i)*Math.sin(i),a},s.prototype.getTransformPoints=function(t,e){for(var n=this.getTransformMatrix(t),r=[],o=0;o<e.length;o++){var s={x:e[o].x,y:e[o].y};s=i.applyToPoint(n,s),r.push(s)}return r.reverse(),r},s.prototype.getPointsCenter=function(t){return{x:(t[0].x+t[2].x)/2,y:(t[0].y+t[2].y)/2}},s.prototype.rectToPoints=function(t){var e=[];return e.push({x:-(this.maskViewSize.width/2-t.left),y:this.maskViewSize.height/2-t.top}),e.push({x:e[0].x+t.width,y:e[0].y}),e.push({x:e[1].x,y:e[1].y-t.height}),e.push({x:e[0].x,y:e[2].y}),e},s.prototype.getTransformMatrix=function(t){for(var e=t.split(" "),n=[],r=0;r<e.length;r++)if(""!=e[r].trim()){var o,s=this.getTransformFunctionName(e[r]);o="rotate"!=s.name?i[s.name](s.params[0],s.params[1]):i[s.name](s.params[0]),n.push(o)}return i.compose(n)},s.prototype.getTransformFunctionName=function(t){for(var e=t.indexOf("("),i=t.indexOf(")"),n={},r=t.substring(e+1,i).split(","),o=[],s=0;s<r.length;s++)o.push(parseFloat(r[s]));n.params=o;var a=t.substring(0,e).toLowerCase(),c=0;return-1!=a.indexOf("scale")?(n.name="scale",c=1):-1!=a.indexOf("translate")?n.name="translate":-1!=a.indexOf("skew")?n.name="skewDEG":-1!=a.indexOf("rotate")&&(n.name="rotateDEG"),-1!=a.indexOf("x")?n.params.push(c):-1!=a.indexOf("y")?n.params.unshift(c):-1==a.indexOf("rotate")&&n.params.length<=1&&n.params.push(n.params[0]),n},s.prototype.getProjectionVector=function(t,e){var i=this.vecLen(e),n=t.x*e.x+t.y*e.y;return{x:n/Math.pow(i,2)*e.x,y:n/Math.pow(i,2)*e.y}},s.prototype.getPCVectorProjOnUpAndRight=function(t,e){var i={x:e[1].x-e[2].x,y:e[1].y-e[2].y},n={x:e[1].x-e[0].x,y:e[1].y-e[0].y},r=this.getPointsCenter(e),o={x:t.x-r.x,y:t.y-r.y};return{up:i,uproj:this.getProjectionVector(o,i),right:n,rproj:this.getProjectionVector(o,n)}},s.prototype.isPointInRectCheckByLen=function(t,e){var i=this.getPCVectorProjOnUpAndRight(t,e),n=Math.round(this.vecLen(i.uproj)*this._precision),r=Math.round(this.vecLen(i.up)/2*this._precision),o=Math.round(this.vecLen(i.rproj)*this._precision),s=Math.round(this.vecLen(i.right)/2*this._precision);return n<=r&&o<=s},s.prototype.isPointInRectCheckByAngle=function(t,e){for(var i=[],n=0;n<e.length;n++){var r=e[n];i.push({x:r.x-t.x,y:r.y-t.y})}var o=0,s=0;for(n=0;n<i.length;n++){var a=this.vecLen(i[n]);(0==a||a<s)&&(o=n,s=a)}a=i.length;var c,h=i.splice(o,1)[0],l=h,u=[];for(n=1;n<a;n++){var p=this.getMinAngle(l,i);l=p.vec,i.splice(p.index,1),u.push(p.angle),1==i.length&&(c=i[0])}u.push(this.getMinAngle(c,[h]).angle);var d=0;for(n=0;n<u.length;n++)d+=u[n];return!((d=d.toFixed(this._precision))<360)},s.prototype.getMinAngle=function(t,e){for(var i=this.vecAngle(t,e[0]),n=0,r=1;r<e.length;r++){var o=this.vecAngle(t,e[r]);o<i&&(i=o,n=r)}return{angle:i,vec:e[n],index:n}},s.prototype.vecAngle=function(t,e){var i=(t.x*e.x+t.y*e.y)/(this.vecLen(t)*this.vecLen(e));return Math.abs(i)>1&&(i=i>0?1:-1),180*Math.acos(i)/Math.PI},s.prototype.vecLen=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},s.prototype.fileToSrc=function(t,e){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.readAsDataURL(t)},s})?n.apply(e,r):n)||(t.exports=o)},function(t,e,i){var n,r,o;r=[],void 0===(o="function"==typeof(n=function(){var t="undefined"!=typeof document?document.createElement("p").style:{},e=["O","ms","Moz","Webkit"],i=/([A-Z])/g,n={};function r(i){if(i=i.replace(/-([a-z])/g,(function(t,e){return e.toUpperCase()})),void 0!==t[i])return i;for(var n=i.charAt(0).toUpperCase()+i.slice(1),r=e.length;r--;){var o=e[r]+n;if(void 0!==t[o])return o}return i}return{prefix:function(t){return t in n?n[t]:n[t]=r(t)},dash:function(t){return t=r(t),i.test(t)&&(t=t.replace(i,"-$1"),i.lastIndex=0),t.toLowerCase()}}})?n.apply(e,r):n)||(t.exports=o)},function(t,e,i){var r;(function(){var i=function(t){return t instanceof i?t:this instanceof i?void(this.EXIFwrapped=t):new i(t)};t.exports&&(e=t.exports=i),e.EXIF=i;var o=i.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},s=i.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},a=i.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},c=i.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},h=i.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function l(t){return!!t.exifdata}function u(t,e){function n(n){var r=p(n);t.exifdata=r||{};var o=function(t){var e=new DataView(t);0;if(255!=e.getUint8(0)||216!=e.getUint8(1))return!1;var i=2,n=t.byteLength,r=function(t,e){return 56===t.getUint8(e)&&66===t.getUint8(e+1)&&73===t.getUint8(e+2)&&77===t.getUint8(e+3)&&4===t.getUint8(e+4)&&4===t.getUint8(e+5)};for(;i<n;){if(r(e,i)){var o=e.getUint8(i+7);o%2!=0&&(o+=1),0===o&&(o=4);var s=i+8+o,a=e.getUint16(i+6+o);return f(t,s,a)}i++}}(n);if(t.iptcdata=o||{},i.isXmpEnabled){var s=function(t){if(!("DOMParser"in self))return;var e=new DataView(t);0;if(255!=e.getUint8(0)||216!=e.getUint8(1))return!1;var i=2,n=t.byteLength,r=new DOMParser;for(;i<n-4;){if("http"==m(e,i,4)){var o=i-1,s=e.getUint16(i-2)-1,a=m(e,o,s),c=a.indexOf("xmpmeta>")+8,h=(a=a.substring(a.indexOf("<x:xmpmeta"),c)).indexOf("x:xmpmeta")+10;return a=a.slice(0,h)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+a.slice(h),x(r.parseFromString(a,"text/xml"))}i++}}(n);t.xmpdata=s||{}}e&&e.call(t)}if(t.src)if(/^data\:/i.test(t.src))n(function(t,e){e=e||t.match(/^data\:([^\;]+)\;base64,/im)[1]||"",t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var i=atob(t),n=i.length,r=new ArrayBuffer(n),o=new Uint8Array(r),s=0;s<n;s++)o[s]=i.charCodeAt(s);return r}(t.src));else if(/^blob\:/i.test(t.src)){(o=new FileReader).onload=function(t){n(t.target.result)},function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="blob",i.onload=function(t){200!=this.status&&0!==this.status||e(this.response)},i.send()}(t.src,(function(t){o.readAsArrayBuffer(t)}))}else{var r=new XMLHttpRequest;r.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";n(r.response),r=null},r.open("GET",t.src,!0),r.responseType="arraybuffer",r.send(null)}else if(self.FileReader&&(t instanceof self.Blob||t instanceof self.File)){var o;(o=new FileReader).onload=function(t){n(t.target.result)},o.readAsArrayBuffer(t)}}function p(t){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return!1;for(var i=2,n=t.byteLength;i<n;){if(255!=e.getUint8(i))return!1;if(225==e.getUint8(i+1))return y(e,i+4,e.getUint16(i+2));i+=2+e.getUint16(i+2)}}var d={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function f(t,e,i){for(var n,r,o,s,a=new DataView(t),c={},h=e;h<e+i;)28===a.getUint8(h)&&2===a.getUint8(h+1)&&(s=a.getUint8(h+2))in d&&((o=a.getInt16(h+3))+5,r=d[s],n=m(a,h+5,o),c.hasOwnProperty(r)?c[r]instanceof Array?c[r].push(n):c[r]=[c[r],n]:c[r]=n),h++;return c}function g(t,e,i,n,r){var o,s,a=t.getUint16(i,!r),c={};for(s=0;s<a;s++)o=i+12*s+2,c[n[t.getUint16(o,!r)]]=v(t,o,e,i,r);return c}function v(t,e,i,n,r){var o,s,a,c,h,l,u=t.getUint16(e+2,!r),p=t.getUint32(e+4,!r),d=t.getUint32(e+8,!r)+i;switch(u){case 1:case 7:if(1==p)return t.getUint8(e+8,!r);for(o=p>4?d:e+8,s=[],c=0;c<p;c++)s[c]=t.getUint8(o+c);return s;case 2:return m(t,o=p>4?d:e+8,p-1);case 3:if(1==p)return t.getUint16(e+8,!r);for(o=p>2?d:e+8,s=[],c=0;c<p;c++)s[c]=t.getUint16(o+2*c,!r);return s;case 4:if(1==p)return t.getUint32(e+8,!r);for(s=[],c=0;c<p;c++)s[c]=t.getUint32(d+4*c,!r);return s;case 5:if(1==p)return h=t.getUint32(d,!r),l=t.getUint32(d+4,!r),(a=new Number(h/l)).numerator=h,a.denominator=l,a;for(s=[],c=0;c<p;c++)h=t.getUint32(d+8*c,!r),l=t.getUint32(d+4+8*c,!r),s[c]=new Number(h/l),s[c].numerator=h,s[c].denominator=l;return s;case 9:if(1==p)return t.getInt32(e+8,!r);for(s=[],c=0;c<p;c++)s[c]=t.getInt32(d+4*c,!r);return s;case 10:if(1==p)return t.getInt32(d,!r)/t.getInt32(d+4,!r);for(s=[],c=0;c<p;c++)s[c]=t.getInt32(d+8*c,!r)/t.getInt32(d+4+8*c,!r);return s}}function m(t,e,i){var r="";for(n=e;n<e+i;n++)r+=String.fromCharCode(t.getUint8(n));return r}function y(t,e){if("Exif"!=m(t,e,4))return!1;var i,n,r,l,u,p=e+6;if(18761==t.getUint16(p))i=!1;else{if(19789!=t.getUint16(p))return!1;i=!0}if(42!=t.getUint16(p+2,!i))return!1;var d=t.getUint32(p+4,!i);if(d<8)return!1;if((n=g(t,p,p+d,s,i)).ExifIFDPointer)for(r in l=g(t,p,p+n.ExifIFDPointer,o,i)){switch(r){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":l[r]=h[r][l[r]];break;case"ExifVersion":case"FlashpixVersion":l[r]=String.fromCharCode(l[r][0],l[r][1],l[r][2],l[r][3]);break;case"ComponentsConfiguration":l[r]=h.Components[l[r][0]]+h.Components[l[r][1]]+h.Components[l[r][2]]+h.Components[l[r][3]]}n[r]=l[r]}if(n.GPSInfoIFDPointer)for(r in u=g(t,p,p+n.GPSInfoIFDPointer,a,i)){switch(r){case"GPSVersionID":u[r]=u[r][0]+"."+u[r][1]+"."+u[r][2]+"."+u[r][3]}n[r]=u[r]}return n.thumbnail=function(t,e,i,n){var r=function(t,e,i){var n=t.getUint16(e,!i);return t.getUint32(e+2+12*n,!i)}(t,e+i,n);if(!r)return{};if(r>t.byteLength)return{};var o=g(t,e,e+r,c,n);if(o.Compression)switch(o.Compression){case 6:if(o.JpegIFOffset&&o.JpegIFByteCount){var s=e+o.JpegIFOffset,a=o.JpegIFByteCount;o.blob=new Blob([new Uint8Array(t.buffer,s,a)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",o.Compression)}else 2==o.PhotometricInterpretation&&console.log("Thumbnail image format is RGB, which is not implemented.");return o}(t,p,d,i),n}function C(t){var e={};if(1==t.nodeType){if(t.attributes.length>0){e["@attributes"]={};for(var i=0;i<t.attributes.length;i++){var n=t.attributes.item(i);e["@attributes"][n.nodeName]=n.nodeValue}}}else if(3==t.nodeType)return t.nodeValue;if(t.hasChildNodes())for(var r=0;r<t.childNodes.length;r++){var o=t.childNodes.item(r),s=o.nodeName;if(null==e[s])e[s]=C(o);else{if(null==e[s].push){var a=e[s];e[s]=[],e[s].push(a)}e[s].push(C(o))}}return e}function x(t){try{var e={};if(t.children.length>0)for(var i=0;i<t.children.length;i++){var n=t.children.item(i),r=n.attributes;for(var o in r){var s=r[o],a=s.nodeName,c=s.nodeValue;void 0!==a&&(e[a]=c)}var h=n.nodeName;if(void 0===e[h])e[h]=C(n);else{if(void 0===e[h].push){var l=e[h];e[h]=[],e[h].push(l)}e[h].push(C(n))}}else e=t.textContent;return e}catch(t){console.log(t.message)}}i.enableXmp=function(){i.isXmpEnabled=!0},i.disableXmp=function(){i.isXmpEnabled=!1},i.getData=function(t,e){return!((self.Image&&t instanceof self.Image||self.HTMLImageElement&&t instanceof self.HTMLImageElement)&&!t.complete)&&(l(t)?e&&e.call(t):u(t,e),!0)},i.getTag=function(t,e){if(l(t))return t.exifdata[e]},i.getIptcTag=function(t,e){if(l(t))return t.iptcdata[e]},i.getAllTags=function(t){if(!l(t))return{};var e,i=t.exifdata,n={};for(e in i)i.hasOwnProperty(e)&&(n[e]=i[e]);return n},i.getAllIptcTags=function(t){if(!l(t))return{};var e,i=t.iptcdata,n={};for(e in i)i.hasOwnProperty(e)&&(n[e]=i[e]);return n},i.pretty=function(t){if(!l(t))return"";var e,i=t.exifdata,n="";for(e in i)i.hasOwnProperty(e)&&("object"==typeof i[e]?i[e]instanceof Number?n+=e+" : "+i[e]+" ["+i[e].numerator+"/"+i[e].denominator+"]\r\n":n+=e+" : ["+i[e].length+" values]\r\n":n+=e+" : "+i[e]+"\r\n");return n},i.readFromBinaryFile=function(t){return p(t)},void 0===(r=function(){return i}.apply(e,[]))||(t.exports=r)}).call(this)},function(t,e,i){"use strict";function n(t,e){return Array.isArray(e)?[t.a*e[0]+t.c*e[1]+t.e,t.b*e[0]+t.d*e[1]+t.f]:{x:t.a*e.x+t.c*e.y+t.e,y:t.b*e.x+t.d*e.y+t.f}}function r(t,e){return e.map(e=>n(t,e))}function o(t){return{a:parseFloat(t.a),b:parseFloat(t.b),c:parseFloat(t.c),d:parseFloat(t.d),e:parseFloat(t.e),f:parseFloat(t.f)}}i.r(e),i.d(e,"applyToPoint",(function(){return n})),i.d(e,"applyToPoints",(function(){return r})),i.d(e,"fromObject",(function(){return o})),i.d(e,"fromString",(function(){return a})),i.d(e,"identity",(function(){return c})),i.d(e,"inverse",(function(){return h})),i.d(e,"isAffineMatrix",(function(){return p})),i.d(e,"rotate",(function(){return C})),i.d(e,"rotateDEG",(function(){return x})),i.d(e,"scale",(function(){return b})),i.d(e,"shear",(function(){return w})),i.d(e,"skew",(function(){return S})),i.d(e,"skewDEG",(function(){return _})),i.d(e,"toCSS",(function(){return M})),i.d(e,"toSVG",(function(){return A})),i.d(e,"toString",(function(){return R})),i.d(e,"transform",(function(){return f})),i.d(e,"compose",(function(){return g})),i.d(e,"translate",(function(){return d})),i.d(e,"fromTriangles",(function(){return T})),i.d(e,"smoothMatrix",(function(){return I})),i.d(e,"fromDefinition",(function(){return L})),i.d(e,"fromTransformAttribute",(function(){return X}));const s=/^matrix\(\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*\)$/i;function a(t){const e=t.match(s);if(null===e||e.length<7)throw new Error(`'${t}' is not a matrix`);return{a:parseFloat(e[1]),b:parseFloat(e[2]),c:parseFloat(e[3]),d:parseFloat(e[4]),e:parseFloat(e[5]),f:parseFloat(e[6])}}function c(){return{a:1,c:0,e:0,b:0,d:1,f:0}}function h(t){const{a:e,b:i,c:n,d:r,e:o,f:s}=t,a=e*r-i*n;return{a:r/a,b:i/-a,c:n/-a,d:e/a,e:(r*o-n*s)/-a,f:(i*o-e*s)/a}}function l(t){return void 0===t}function u(t){return"number"==typeof t&&!Number.isNaN(t)&&Number.isFinite(t)}function p(t){return"object"==typeof(e=t)&&null!==e&&!Array.isArray(e)&&"a"in t&&u(t.a)&&"b"in t&&u(t.b)&&"c"in t&&u(t.c)&&"d"in t&&u(t.d)&&"e"in t&&u(t.e)&&"f"in t&&u(t.f);var e}function d(t,e=0){return{a:1,c:0,e:t,b:0,d:1,f:e}}function f(...t){const e=(t,e)=>({a:t.a*e.a+t.c*e.b,c:t.a*e.c+t.c*e.d,e:t.a*e.e+t.c*e.f+t.e,b:t.b*e.a+t.d*e.b,d:t.b*e.c+t.d*e.d,f:t.b*e.e+t.d*e.f+t.f});switch((t=Array.isArray(t[0])?t[0]:t).length){case 0:throw new Error("no matrices provided");case 1:return t[0];case 2:return e(t[0],t[1]);default:{const[i,n,...r]=t;return f(e(i,n),...r)}}}function g(...t){return f(...t)}const{cos:v,sin:m,PI:y}=Math;function C(t,e,i){const n=v(t),r=m(t),o={a:n,c:-r,e:0,b:r,d:n,f:0};return l(e)||l(i)?o:f([d(e,i),o,d(-e,-i)])}function x(t,e,i){return C(t*y/180,e,i)}function b(t,e,i,n){l(e)&&(e=t);const r={a:t,c:0,e:0,b:0,d:e,f:0};return l(i)||l(n)?r:f([d(i,n),r,d(-i,-n)])}function w(t,e){return{a:1,c:t,e:0,b:e,d:1,f:0}}const{tan:P}=Math;function S(t,e){return{a:1,c:P(t),e:0,b:P(e),d:1,f:0}}function _(t,e){return S(t*Math.PI/180,e*Math.PI/180)}function M(t){return R(t)}function A(t){return R(t)}function R(t){return`matrix(${t.a},${t.b},${t.c},${t.d},${t.e},${t.f})`}function I(t,e=1e10){return{a:Math.round(t.a*e)/e,b:Math.round(t.b*e)/e,c:Math.round(t.c*e)/e,d:Math.round(t.d*e)/e,e:Math.round(t.e*e)/e,f:Math.round(t.f*e)/e}}function T(t,e){const i=null!=t[0].x?t[0].x:t[0][0],n=null!=t[0].y?t[0].y:t[0][1],r=null!=e[0].x?e[0].x:e[0][0],o=null!=e[0].y?e[0].y:e[0][1],s=null!=t[1].x?t[1].x:t[1][0],a=null!=t[1].y?t[1].y:t[1][1],c=null!=e[1].x?e[1].x:e[1][0],l=null!=e[1].y?e[1].y:e[1][1],u=null!=t[2].x?t[2].x:t[2][0],p=null!=t[2].y?t[2].y:t[2][1],d=null!=e[2].x?e[2].x:e[2][0],g=null!=e[2].y?e[2].y:e[2][1];return I(f([{a:r-d,b:o-g,c:c-d,d:l-g,e:d,f:g},h({a:i-u,b:n-p,c:s-u,d:a-p,e:u,f:p})]))}function L(t){return Array.isArray(t)?t.map(e):e(t);function e(t){switch(t.type){case"matrix":if("a"in t&&"b"in t&&"c"in t&&"d"in t&&"e"in t&&"f"in t)return o(t);throw new Error("MISSING_MANDATORY_PARAM");case"translate":if(!("tx"in t))throw new Error("MISSING_MANDATORY_PARAM");return"ty"in t?d(t.tx,t.ty):d(t.tx);case"scale":if(!("sx"in t))throw new Error("MISSING_MANDATORY_PARAM");return"sy"in t?b(t.sx,t.sy):b(t.sx);case"rotate":if(!("angle"in t))throw new Error("MISSING_MANDATORY_PARAM");return"cx"in t&&"cy"in t?x(t.angle,t.cx,t.cy):x(t.angle);case"skewX":if(!("angle"in t))throw new Error("MISSING_MANDATORY_PARAM");return _(t.angle,0);case"skewY":if(!("angle"in t))throw new Error("MISSING_MANDATORY_PARAM");return _(0,t.angle);case"shear":if(!("shx"in t)||!("shy"in t))throw new Error("MISSING_MANDATORY_PARAM");return w(t.shx,t.shy);default:throw new Error("UNSUPPORTED_DESCRIPTOR")}}}function $(t,e,i,n){this.message=t,this.expected=e,this.found=i,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,$)}function F(t,e){e=void 0!==e?e:{};var i,n={},r={transformList:k},o=k,s=/^[eE]/,a=/^[+\-]/,c=/^[0-9]/,h=/^[ \t\r\n]/,l=R("matrix",!1),u=R("(",!1),p=R(")",!1),d=R("translate",!1),f=R("scale",!1),g=R("rotate",!1),v=R("skewX",!1),m=R("skewY",!1),y=R(",",!1),C=T("fractionalConstant"),x=I(["e","E"],!1,!1),b=I(["+","-"],!1,!1),w=I([["0","9"]],!1,!1),P=I([" ","\t","\r","\n"],!1,!1),S=0,_=[{line:1,column:1}],M=[],A=0;if("startRule"in e){if(!(e.startRule in r))throw new Error("Can't start parsing from rule \""+e.startRule+'".');o=r[e.startRule]}function R(t,e){return{type:"literal",text:t,ignoreCase:e}}function I(t,e,i){return{type:"class",parts:t,inverted:e,ignoreCase:i}}function T(t){return{type:"other",description:t}}function L(e){var i,n=_[e];if(n)return n;for(i=e-1;!_[i];)i--;for(n={line:(n=_[i]).line,column:n.column};i<e;)10===t.charCodeAt(i)?(n.line++,n.column=1):n.column++,i++;return _[e]=n,n}var F="string"==typeof e.filename&&e.filename.length>0;function X(t,i){var n={};F&&(n.filename=e.filename);var r=L(t);n.start={offset:t,line:r.line,column:r.column};var o=L(i);return n.end={offset:i,line:o.line,column:o.column},n}function O(t){var e=M[M.length-1];S<e.pos||(S>e.pos&&(e.pos=S,e.variants=[]),e.variants.push(t))}function D(t,e,i){return new $($.buildMessage(t,e,i),t,e,i)}function k(){var t,e,i,r,o;for(t=S,e=[],i=V();i!==n;)e.push(i),i=V();for((i=function t(){var e,i,r,o;if(e=S,(i=E())!==n){if(r=[],(o=z())!==n)for(;o!==n;)r.push(o),o=z();else r=n;r!==n&&(o=t())!==n?(e,s=o,e=i.concat(s)):(S=e,e=n)}else S=e,e=n;var s;e===n&&(e=E());return e}())===n&&(i=null),r=[],o=V();o!==n;)r.push(o),o=V();return t,t=i}function E(){var e;return(e=function(){var e,i,r,o,s,a,c,h,d,f,g,v,m,y=function(t){0===A&&O(t)};e=S,y(l),"matrix"===t.substr(S,6)?(i="matrix",S+=6):i=n;if(i!==n){for(r=[],o=V();o!==n;)r.push(o),o=V();if(y(u),40===t.charCodeAt(S)?(o="(",S++):o=n,o!==n){for(s=[],a=V();a!==n;)s.push(a),a=V();if((a=B())!==n)if(z()!==n)if((c=B())!==n)if(z()!==n)if((h=B())!==n)if(z()!==n)if((d=B())!==n)if(z()!==n)if((f=B())!==n)if(z()!==n)if((g=B())!==n){for(v=[],m=V();m!==n;)v.push(m),m=V();y(p),41===t.charCodeAt(S)?(m=")",S++):m=n,m!==n?(e,e=[{type:"matrix",a:a,b:c,c:h,d:d,e:f,f:g}]):(S=e,e=n)}else S=e,e=n;else S=e,e=n;else S=e,e=n;else S=e,e=n;else S=e,e=n;else S=e,e=n;else S=e,e=n;else S=e,e=n;else S=e,e=n;else S=e,e=n;else S=e,e=n}else S=e,e=n}else S=e,e=n;return e}())===n&&(e=function(){var e,i,r,o,s,a,c,h,l,f=function(t){0===A&&O(t)};e=S,f(d),"translate"===t.substr(S,9)?(i="translate",S+=9):i=n;if(i!==n){for(r=[],o=V();o!==n;)r.push(o),o=V();if(f(u),40===t.charCodeAt(S)?(o="(",S++):o=n,o!==n){for(s=[],a=V();a!==n;)s.push(a),a=V();if((a=B())!==n){for((c=Y())===n&&(c=null),h=[],l=V();l!==n;)h.push(l),l=V();f(p),41===t.charCodeAt(S)?(l=")",S++):l=n,l!==n?(e,v={type:"translate",tx:a},(g=c)&&(v.ty=g),e=[v]):(S=e,e=n)}else S=e,e=n}else S=e,e=n}else S=e,e=n;var g,v;return e}())===n&&(e=function(){var e,i,r,o,s,a,c,h,l,d=function(t){0===A&&O(t)};e=S,d(f),"scale"===t.substr(S,5)?(i="scale",S+=5):i=n;if(i!==n){for(r=[],o=V();o!==n;)r.push(o),o=V();if(d(u),40===t.charCodeAt(S)?(o="(",S++):o=n,o!==n){for(s=[],a=V();a!==n;)s.push(a),a=V();if((a=B())!==n){for((c=Y())===n&&(c=null),h=[],l=V();l!==n;)h.push(l),l=V();d(p),41===t.charCodeAt(S)?(l=")",S++):l=n,l!==n?(e,v={type:"scale",sx:a},(g=c)&&(v.sy=g),e=[v]):(S=e,e=n)}else S=e,e=n}else S=e,e=n}else S=e,e=n;var g,v;return e}())===n&&(e=function(){var e,i,r,o,s,a,c,h,l,d=function(t){0===A&&O(t)};e=S,d(g),"rotate"===t.substr(S,6)?(i="rotate",S+=6):i=n;if(i!==n){for(r=[],o=V();o!==n;)r.push(o),o=V();if(d(u),40===t.charCodeAt(S)?(o="(",S++):o=n,o!==n){for(s=[],a=V();a!==n;)s.push(a),a=V();if((a=B())!==n){for((c=function(){var t,e,i;t=S,z()!==n&&(e=B())!==n&&z()!==n&&(i=B())!==n?(t,t=[e,i]):(S=t,t=n);return t}())===n&&(c=null),h=[],l=V();l!==n;)h.push(l),l=V();d(p),41===t.charCodeAt(S)?(l=")",S++):l=n,l!==n?(e,v={type:"rotate",angle:a},(f=c)&&(v.cx=f[0],v.cy=f[1]),e=[v]):(S=e,e=n)}else S=e,e=n}else S=e,e=n}else S=e,e=n;var f,v;return e}())===n&&(e=function(){var e,i,r,o,s,a,c,h,l=function(t){0===A&&O(t)};e=S,l(v),"skewX"===t.substr(S,5)?(i="skewX",S+=5):i=n;if(i!==n){for(r=[],o=V();o!==n;)r.push(o),o=V();if(l(u),40===t.charCodeAt(S)?(o="(",S++):o=n,o!==n){for(s=[],a=V();a!==n;)s.push(a),a=V();if((a=B())!==n){for(c=[],h=V();h!==n;)c.push(h),h=V();l(p),41===t.charCodeAt(S)?(h=")",S++):h=n,h!==n?(e,e=[{type:"skewX",angle:a}]):(S=e,e=n)}else S=e,e=n}else S=e,e=n}else S=e,e=n;return e}())===n&&(e=function(){var e,i,r,o,s,a,c,h,l=function(t){0===A&&O(t)};e=S,l(m),"skewY"===t.substr(S,5)?(i="skewY",S+=5):i=n;if(i!==n){for(r=[],o=V();o!==n;)r.push(o),o=V();if(l(u),40===t.charCodeAt(S)?(o="(",S++):o=n,o!==n){for(s=[],a=V();a!==n;)s.push(a),a=V();if((a=B())!==n){for(c=[],h=V();h!==n;)c.push(h),h=V();l(p),41===t.charCodeAt(S)?(h=")",S++):h=n,h!==n?(e,e=[{type:"skewY",angle:a}]):(S=e,e=n)}else S=e,e=n}else S=e,e=n}else S=e,e=n;return e}()),e}function B(){var e,i,r,o;return e=S,i=S,(r=j())===n&&(r=null),(o=function(){var e,i,r;e=S,(i=function(){var e,i,r,o;(function(t){0===A&&O(t)})(C),A++,e=S,(i=G())===n&&(i=null);46===t.charCodeAt(S)?(r=".",S++):r=n;r!==n&&(o=G())!==n?(e,a=o,e=[(s=i)?s.join(""):null,".",a.join("")].join("")):(S=e,e=n);var s,a;e===n&&(e=S,(i=G())!==n?(46===t.charCodeAt(S)?(r=".",S++):r=n,r!==n?(e,e=i.join("")):(S=e,e=n)):(S=e,e=n));return A--,e}())!==n?((r=W())===n&&(r=null),e,e=[i,r||null].join("")):(S=e,e=n);e===n&&(e=S,(i=G())!==n&&(r=W())!==n?(e,e=function(t,e){return[t,e].join("")}(i,r)):(S=e,e=n));return e}())!==n?i=r=[r,o]:(S=i,i=n),i!==n&&(e,i=parseFloat(i.join(""))),(e=i)===n&&(e=S,i=S,(r=j())===n&&(r=null),(o=function(){var t,e;t=S,(e=G())!==n&&(t,e=e.join(""));return t=e}())!==n?i=r=[r,o]:(S=i,i=n),i!==n&&(e,i=parseInt(i.join(""))),e=i),e}function Y(){var t,e;return t=S,z()!==n&&(e=B())!==n?(t,t=e):(S=t,t=n),t}function z(){var t,e,i,r,o;if(t=S,e=[],(i=V())!==n)for(;i!==n;)e.push(i),i=V();else e=n;if(e!==n){for((i=U())===n&&(i=null),r=[],o=V();o!==n;)r.push(o),o=V();t=e=[e,i,r]}else S=t,t=n;if(t===n)if(t=S,(e=U())!==n){for(i=[],r=V();r!==n;)i.push(r),r=V();t=e=[e,i]}else S=t,t=n;return t}function U(){var e;return function(t){0===A&&O(t)}(y),44===t.charCodeAt(S)?(e=",",S++):e=n,e}function W(){var e,i,r,o;return e=S,function(t){0===A&&O(t)}(x),s.test(t.charAt(S))?(i=t.charAt(S),S++):i=n,i!==n?((r=j())===n&&(r=null),(o=G())!==n?(e,e=["e",r,o.join("")].join("")):(S=e,e=n)):(S=e,e=n),e}function j(){var e;return function(t){0===A&&O(t)}(b),a.test(t.charAt(S))?(e=t.charAt(S),S++):e=n,e}function G(){var t,e;if(t=[],(e=N())!==n)for(;e!==n;)t.push(e),e=N();else t=n;return t}function N(){var e;return function(t){0===A&&O(t)}(w),c.test(t.charAt(S))?(e=t.charAt(S),S++):e=n,e}function V(){var e;return function(t){0===A&&O(t)}(P),h.test(t.charAt(S))?(e=t.charAt(S),S++):e=n,e}if(M.push({pos:S,variants:[]}),(i=o())!==n&&S===t.length)return i;throw i!==n&&S<t.length&&O({type:"end"}),function(){var e=M[0],i=e.pos;return D(e.variants,i<t.length?t.charAt(i):null,i<t.length?X(i,i+1):X(i,i))}()}!function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i}($,Error),$.buildMessage=function(t,e,i){var n={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?s(t[0])+"-"+s(t[1]):s(t)}));return"["+(t.inverted?"^":"")+e+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description},not:function(t){return"not "+a(t.expected)}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function s(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function a(t){return n[t.type](t)}return"Expected "+function(t){var e,i,n=t.map(a);if(n.sort(),n.length>0){for(e=1,i=1;e<n.length;e++)n[e-1]!==n[e]&&(n[i]=n[e],i++);n.length=i}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(e)+" found."};function X(t){return F(t)}}])}));